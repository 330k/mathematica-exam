<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
        "HTMLFiles/xhtml-math11-f.dtd">

<!-- Created by Wolfram Mathematica 8.0 : www.wolfram.com -->

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>
  東京大学 2013年 理科 第3問
 </title>
 <script async src="https://www.googletagmanager.com/gtag/js?id=G-KKHNSLLCT8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KKHNSLLCT8');
</script>
 <link rel="shortcut icon" href="/mathematica-exam/favicon.ico">
 <link href="HTMLFiles/ut-2013-03.css" rel="stylesheet" type="text/css" />
</head>

<body>

<p class="Title">
 東京大学 2013年 理科 第3問
</p>



<p class="Section">
 問題
</p>



<p class="Text">
 A, Bの2人がいる。投げたとき表裏の出る確率がそれぞれ<span><span><img src="HTMLFiles/ut-2013-03_1.png" alt="ut-2013-03_1.png" width="14" height="37" style="vertical-align:middle" /></span></span>のコインが1枚あり、最初はAがそのコインを持っている。次の操作を繰り返す。
</p>



<p class="Text">
 (i)&nbsp;&nbsp;&nbsp;&nbsp;Aがコインを持っているときは、コインを投げ、表が出ればAに1点を与え、コインはAがそのまま持つ。裏が出れば、両者に点を与えず、AはコインをBに渡す。
</p>



<p class="Text">
 (ii)&nbsp;&nbsp;&nbsp;&nbsp;Bがコインを持っているときは、コインを投げ、表が出ればBに1点を与え、コインはBがそのまま持つ。裏が出れば、両者に点を与えず、BはコインをAに渡す。
</p>



<p class="Text">
 そしてA, Bのいずれかが2点を獲得した時点で、2点を獲得した方の勝利とする。ただとえば、コインが表、裏、表、表と出た場合、この時点でAは1点、Bは2点を獲得しているのでBの勝利とのなる。
</p>



<p class="Text">
 (1)&nbsp;&nbsp;&nbsp;&nbsp;A、Bあわせてちょうど<span><em>n</em></span>回コインを投げ終えたときにAの勝利となる確率<span><em>p</em><em>(</em><em>n</em><em>)</em></span>を求めよ。
</p>



<p class="Text">
 (2)&nbsp;&nbsp;&nbsp;&nbsp;<span><span><img src="HTMLFiles/ut-2013-03_2.png" alt="ut-2013-03_2.png" width="60" height="33" style="vertical-align:middle" /></span></span>を求めよ。
</p>



<p class="Section">
 解答
</p>



<p class="Subsection">
 (1)
</p>



<p class="Text">
 起きうる状態は<br />・p00A: Aが0点、Bが0点、Aがコインを持っている<br />・p00B: Aが0点、Bが0点、Bがコインを持っている<br />・p10A: Aが1点、Bが0点、Aがコインを持っている<br />・p10B: Aが1点、Bが0点、Bがコインを持っている<br />・p01A: Aが0点、Bが1点、Aがコインを持っている<br />・p01B: Aが0点、Bが1点、Bがコインを持っている<br />・p11A: Aが1点、Bが1点、Aがコインを持っている<br />・p11B: Aが1点、Bが1点、Bがコインを持っている<br />・p20: Aが2点、Bが0点<br />・p02: Aが0点、Bが2点<br />・p21: Aが2点、Bが1点<br />・p12: Aが1点、Bが2点<br />の12通り。これらの状態の、初期状態と状態間の遷移確率を漸化式で表してRSolveで解く。
</p>



<p class="Input">
 <img src="HTMLFiles/ut-2013-03_3.png" alt="ut-2013-03_3.png" width="552" height="529" style="vertical-align:middle" />
</p>

<p class="Output">
 <img src="HTMLFiles/ut-2013-03_4.png" alt="ut-2013-03_4.png" width="609" height="138" style="vertical-align:middle" />
</p>

<p class="Text">
 求める確率<span><em>p</em><em>(</em><em>n</em><em>)</em></span>はp20 + p21だから、
</p>



<p class="Input">
 <img src="HTMLFiles/ut-2013-03_5.gif" alt="ut-2013-03_5.gif" width="502" height="35" style="vertical-align:middle" />
</p>

<p class="Output">
 <img src="HTMLFiles/ut-2013-03_6.png" alt="ut-2013-03_6.png" width="307" height="19" style="vertical-align:middle" />
</p>

<p class="Subsection">
 (2)
</p>



<p class="Input">
 <img src="HTMLFiles/ut-2013-03_7.png" alt="ut-2013-03_7.png" width="215" height="15" style="vertical-align:middle" />
</p>

<p class="Output">
 <img src="HTMLFiles/ut-2013-03_8.png" alt="ut-2013-03_8.png" width="21" height="39" style="vertical-align:middle" />
</p>

<p class="Section">
 補足・感想
</p>



<p class="Text">
 (1)は遷移確率行列にしたほうがプログラムを書く時に間違いが少ないかもしれない。
</p>



<p class="Input">
 <img src="HTMLFiles/ut-2013-03_9.png" alt="ut-2013-03_9.png" width="410" height="189" style="vertical-align:middle" />
</p>

<p class="Text">
 <span style='font-style: italic;'>Mathematica</span> 8ではMatrixPowerで<span><em>n</em></span>乗を計算してくれなかったが、最新のMathematicaなら大丈夫。
</p>



<p class="Input">
 <img src="HTMLFiles/ut-2013-03_10.png" alt="ut-2013-03_10.png" width="456" height="15" style="vertical-align:middle" />
</p>

<p class="Output">
 <img src="HTMLFiles/ut-2013-03_11.png" alt="ut-2013-03_11.png" width="647" height="306" style="vertical-align:middle" />
</p>

<p class="Text">
 Wolfram Cloudで上の計算を実行すると以下の計算結果が返ってくるので、以下はそれを利用して続ける。
</p>



<p class="Input">
 <img src="HTMLFiles/ut-2013-03_12.png" alt="ut-2013-03_12.png" width="590" height="130" style="vertical-align:middle" />
</p>

<p class="Text">
 求める<span><em>p</em><em>(</em><em>n</em><em>)</em></span>は
</p>



<p class="Input">
 <img src="HTMLFiles/ut-2013-03_13.png" alt="ut-2013-03_13.png" width="291" height="15" style="vertical-align:middle" />
</p>

<p class="Output">
 <img src="HTMLFiles/ut-2013-03_14.png" alt="ut-2013-03_14.png" width="307" height="19" style="vertical-align:middle" />
</p>

<p class="Text">
 となって、RSolveを使ったときと同じ解を得る。
</p>






<div style="font-family:Helvetica; font-size:11px; width:100%; border:1px none #999999; border-top-style:solid; padding-top:2px; margin-top:20px;">
 <a href="http://www.wolfram.com/products/mathematica/" style="color:#000; text-decoration:none;">
  <img src="HTMLFiles/spikeyIcon.png" alt="Spikey" width="20" height="21" style="padding-right:2px; border:0px solid white; vertical-align:middle;" />
  <span style="color:#555555">Created with</span> Wolfram <span style="font-style: italic;">Mathematica</span> 8.0
 </a>
</div>
</body>

</html>